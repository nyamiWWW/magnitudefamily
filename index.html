<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magnitude Family - Space Map</title>
    <style>
        body {
            background-color: #05070a;
            color: #ffffff;
            font-family: 'Segoe UI', sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: #0d1117;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #30363d;
        }
        h1 { color: #58a6ff; }
        #map-display {
            width: 100%;
            border-radius: 10px;
            border: 2px solid #30363d;
            margin-bottom: 20px;
        }
        .upload-box {
            background: #161b22;
            padding: 20px;
            border-radius: 10px;
            border: 1px dashed #444;
        }
        .btn {
            background: #238636;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: 0.2s;
        }
        .btn:hover { background: #2ea043; transform: scale(1.02); }
        .btn:disabled { background: #444; }
        #status { margin-top: 15px; font-size: 14px; color: #8b949e; }
        .loader {
            display: none;
            margin: 10px auto;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #238636;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="container">
    <h1>üåå Magnitude Family Space</h1>
    <p>–î–æ–¥–∞–π —Å–≤–æ—î —Ñ–æ—Ç–æ —Ç–∞ —Å—Ç–∞–Ω—å —á–∞—Å—Ç–∏–Ω–æ—é –Ω–∞—à–æ—ó —Å–ø—ñ–ª—å–Ω–æ—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç—ñ!</p>
    
    <img id="map-display" src="main_map.png" alt="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ—Å–º—ñ—á–Ω–æ—ó –∫–∞—Ä—Ç–∏...">
    
    <div class="upload-box">
        <input type="file" id="avatarInput" accept="image/png, image/jpeg">
        <br><br>
        <button class="btn" id="uploadBtn" onclick="sendToSpace()">üöÄ –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –º–æ—î PFP</button>
        <div class="loader" id="loader"></div>
        <div id="status"></div>
    </div>

    <p style="font-size: 12px; margin-top: 20px;">
        <a href="main_map.png" download="magnitude_family_space.png" style="color: #58a6ff; text-decoration: none;">
            ‚¨áÔ∏è –°–∫–∞—á–∞—Ç–∏ –∫–∞—Ä—Ç—É –≤ –ø–æ–≤–Ω—ñ–π —è–∫–æ—Å—Ç—ñ
        </a>
    </p>
</div>

<script>
    async function sendToSpace() {
        const fileInput = document.getElementById('avatarInput');
        const status = document.getElementById('status');
        const loader = document.getElementById('loader');
        const btn = document.getElementById('uploadBtn');

        if (!fileInput.files[0]) {
            alert("–ë—É–¥—å –ª–∞—Å–∫–∞, —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ç–æ!");
            return;
        }

        // –¢–≤–æ—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è Pipedream
        const PIPEDREAM_URL = "https://eoegyiszag3c5nz.m.pipedream.net"; 

        btn.disabled = true;
        loader.style.display = "block";
        status.innerText = "–ó–≤'—è–∑–æ–∫ —ñ–∑ —Å–µ—Ä–≤–µ—Ä–æ–º... –§–æ—Ç–æ –ª–µ—Ç–∏—Ç—å —É –∫–æ—Å–º–æ—Å!";

        const file = fileInput.files[0];
        const reader = new FileReader();
        
        reader.onload = async function() {
            const base64Content = reader.result.split(',')[1];
            const fileName = `pfp_${Date.now()}.png`;

            try {
                const response = await fetch(PIPEDREAM_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        filename: fileName,
                        content: base64Content
                    })
                });

                if (response.ok) {
                    status.style.color = "#7ee787";
                    status.innerText = "‚úÖ –£—Å–ø—ñ—Ö! –†–æ–±–æ—Ç GitHub –ø–æ—á–∞–≤ –æ–±—Ä–æ–±–∫—É. –ó–∞—á–µ–∫–∞–π 1-2 —Ö–≤–∏–ª–∏–Ω–∏ —ñ –∫–∞—Ä—Ç–∞ –æ–Ω–æ–≤–∏—Ç—å—Å—è.";
                    fileInput.value = "";
                } else {
                    throw new Error();
                }
            } catch (e) {
                status.style.color = "#ff7b72";
                status.innerText = "‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑.";
            } finally {
                btn.disabled = false;
                loader.style.display = "none";
            }
        };
        
        reader.readAsDataURL(file);
    }

    // –ê–≤—Ç–æ-–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    setInterval(() => {
        const img = document.getElementById('map-display');
        img.src = "main_map.png?v=" + new Date().getTime();
    }, 45000);
</script>

</body>
</html>
